# ═══════════════════════════════════════════════════════════════════════════════
# Triple-Hybrid-RAG Configuration (Development)
# Generated: 2026-01-17
# ═══════════════════════════════════════════════════════════════════════════════

# ───────────────────────────────────────────────────────────────────────────────
# DATABASE (Docker Compose defaults)
# ───────────────────────────────────────────────────────────────────────────────
DATABASE_URL=postgresql://postgres:postgres@localhost:54332/rag_db
DATABASE_POOL_SIZE=10
DATABASE_MAX_OVERFLOW=20

# ───────────────────────────────────────────────────────────────────────────────
# OPENAI API
# Set your API key here for query planner and entity extraction
# ───────────────────────────────────────────────────────────────────────────────
OPENAI_API_KEY=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
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_MODEL=gpt-5-nano

# ───────────────────────────────────────────────────────────────────────────────
# EMBEDDING API (Local vLLM / Ollama / LM Studio)
# ───────────────────────────────────────────────────────────────────────────────
RAG_EMBED_API_BASE=http://127.0.0.1:1234/v1
RAG_EMBED_MODEL=Qwen/Qwen3-VL-Embedding-2B
RAG_EMBED_BATCH_SIZE=200
RAG_EMBED_CONCURRENT_BATCHES=8
RAG_EMBED_TIMEOUT=60.0
RAG_EMBED_DIM_MODEL=2048
RAG_EMBED_DIM_STORE=1024

# ───────────────────────────────────────────────────────────────────────────────
# RERANKING API
# ───────────────────────────────────────────────────────────────────────────────
RAG_RERANK_API_BASE=http://127.0.0.1:1235/v1
RAG_RERANK_MODEL=Qwen/Qwen3-VL-Reranker-2B
RAG_RERANK_TIMEOUT=30.0

# ───────────────────────────────────────────────────────────────────────────────
# OCR API
# ───────────────────────────────────────────────────────────────────────────────
RAG_OCR_API_BASE=http://127.0.0.1:1237/v1
RAG_OCR_MODEL=Qwen/Qwen3-VL-8B
RAG_OCR_TIMEOUT=60.0
RAG_DEEPSEEK_OCR_API_BASE=http://127.0.0.1:1236/v1
RAG_DEEPSEEK_OCR_MODEL=deepseek-ai/DeepSeek-OCR

# ───────────────────────────────────────────────────────────────────────────────
# PUPPYGRAPH (Docker Compose defaults)
# ───────────────────────────────────────────────────────────────────────────────
PUPPYGRAPH_BOLT_URL=bolt://localhost:7697
PUPPYGRAPH_HTTP_URL=http://localhost:8192
PUPPYGRAPH_WEB_UI_URL=http://localhost:8091
PUPPYGRAPH_USERNAME=admin
PUPPYGRAPH_PASSWORD=puppygraph123
PUPPYGRAPH_TIMEOUT=30.0

# ───────────────────────────────────────────────────────────────────────────────
# FEATURE FLAGS (All enabled for development)
# ───────────────────────────────────────────────────────────────────────────────
RAG_ENABLED=true
RAG_LEXICAL_ENABLED=true
RAG_SEMANTIC_ENABLED=true
RAG_GRAPH_ENABLED=true
RAG_RERANK_ENABLED=true
RAG_DENOISE_ENABLED=true
RAG_QUERY_PLANNER_ENABLED=true
RAG_ENTITY_EXTRACTION_ENABLED=true
RAG_OCR_ENABLED=true
RAG_DEEPSEEK_OCR_ENABLED=false
RAG_MULTIMODAL_EMBEDDING_ENABLED=true

# ───────────────────────────────────────────────────────────────────────────────
# INGESTION SETTINGS
# ───────────────────────────────────────────────────────────────────────────────
RAG_INGEST_EMBED_RETRY_ATTEMPTS=3
RAG_INGEST_DB_RETRY_ATTEMPTS=3
RAG_INGEST_RETRY_BACKOFF_MIN=1.0
RAG_INGEST_RETRY_BACKOFF_MAX=10.0
RAG_DB_BATCH_SIZE=1000

# ───────────────────────────────────────────────────────────────────────────────
# EMBEDDING CACHE (In-memory for development)
# ───────────────────────────────────────────────────────────────────────────────
RAG_EMBEDDING_CACHE_ENABLED=true
RAG_EMBEDDING_CACHE_BACKEND=memory
RAG_EMBEDDING_CACHE_MAX_SIZE=100000
RAG_EMBEDDING_CACHE_TTL=604800
RAG_EMBEDDING_CACHE_REDIS_URL=redis://localhost:6379

# ───────────────────────────────────────────────────────────────────────────────
# PIPELINED INGESTION
# ───────────────────────────────────────────────────────────────────────────────
RAG_PIPELINE_ENABLED=true
RAG_PIPELINE_QUEUE_SIZE=10

# ───────────────────────────────────────────────────────────────────────────────
# CHUNKING CONFIGURATION
# ───────────────────────────────────────────────────────────────────────────────
RAG_PARENT_CHILD_CHUNKING=true
RAG_MATRYOSHKA_EMBEDDINGS=true
RAG_PARENT_CHUNK_TOKENS=800
RAG_PARENT_CHUNK_MAX_TOKENS=1000
RAG_CHILD_CHUNK_TOKENS=200
RAG_CHUNK_OVERLAP_TOKENS=50

# ───────────────────────────────────────────────────────────────────────────────
# RETRIEVAL CONFIGURATION
# ───────────────────────────────────────────────────────────────────────────────
RAG_LEXICAL_WEIGHT=0.7
RAG_SEMANTIC_WEIGHT=0.8
RAG_GRAPH_WEIGHT=1.0
RAG_SAFETY_THRESHOLD=0.6
RAG_DENOISE_ALPHA=0.6
RAG_LEXICAL_TOP_K=50
RAG_SEMANTIC_TOP_K=100
RAG_GRAPH_TOP_K=50
RAG_RERANK_TOP_K=20
RAG_FINAL_TOP_K=5

# ───────────────────────────────────────────────────────────────────────────────
# QUERY PLANNER & ENTITY EXTRACTION
# ───────────────────────────────────────────────────────────────────────────────
RAG_QUERY_PLANNER_MODEL=gpt-5-nano
RAG_QUERY_PLANNER_TEMPERATURE=0.0
RAG_NER_MODEL=gpt-5-nano
RAG_NER_TEMPERATURE=0.0
RAG_NER_MAX_CHUNKS_PER_REQUEST=8
RAG_NER_MAX_CHARS_PER_CHUNK=2000
RAG_ENTITY_TYPES=PERSON,ORGANIZATION,PRODUCT,CLAUSE,DATE,MONEY,LOCATION,TECHNICAL_TERM

# ───────────────────────────────────────────────────────────────────────────────
# GUNDAM TILING OCR
# ───────────────────────────────────────────────────────────────────────────────
RAG_GUNDAM_TILING_ENABLED=true
RAG_GUNDAM_MIN_IMAGE_SIZE=1500
RAG_GUNDAM_TILE_SIZE=1024
RAG_GUNDAM_OVERLAP=128
RAG_GUNDAM_MAX_TILES=16
RAG_GUNDAM_MERGE_STRATEGY=fuzzy
RAG_GUNDAM_FUZZY_THRESHOLD=0.85

# ───────────────────────────────────────────────────────────────────────────────
# OBSERVABILITY & LOGGING
# ───────────────────────────────────────────────────────────────────────────────
RAG_METRICS_ENABLED=false
RAG_METRICS_PORT=9190
LOG_LEVEL=INFO
LOG_FORMAT=json
