# Voice Agent Pipecat - Environment Variables
# Copy this file to .env and fill in your values

# ──────────────────────────────────────────────────────────────────────────────
# OpenAI LLM
# ──────────────────────────────────────────────────────────────────────────────
OPENAI_API_KEY=sk-your-openai-api-key
OPENAI_MODEL=gpt-4o-mini
OPENAI_BASE_URL=https://api.openai.com/v1

# ──────────────────────────────────────────────────────────────────────────────
# Cartesia TTS/STT
# ──────────────────────────────────────────────────────────────────────────────
CARTESIA_API_KEY=your-cartesia-api-key
CARTESIA_VOICE_ID=your-voice-id
CARTESIA_STT_LANGUAGE=pt

# ──────────────────────────────────────────────────────────────────────────────
# Supabase Database
# ──────────────────────────────────────────────────────────────────────────────
SUPABASE_URL=https://your-project.supabase.co
SERVICE_ROLE_KEY=your-service-role-key

# ──────────────────────────────────────────────────────────────────────────────
# System Prompt
# ──────────────────────────────────────────────────────────────────────────────
CUSTOM_PROMPT_FILE=PROMPT_v3.md

# ──────────────────────────────────────────────────────────────────────────────
# Evolution API (WhatsApp)
# ──────────────────────────────────────────────────────────────────────────────
EVOLUTION_API_URL=http://localhost:8080
EVOLUTION_API_KEY=your-evolution-api-key
EVOLUTION_INSTANCE_NAME=ai_agent_01

# ──────────────────────────────────────────────────────────────────────────────
# Google Calendar
# ──────────────────────────────────────────────────────────────────────────────
GOOGLE_SERVICE_ACCOUNT_PATH=data/google_calendar_service_account.json
GOOGLE_CALENDAR_AUTH_MODE=service_account
GOOGLE_CALENDAR_DEFAULT_ORG_ID=your-org-uuid

# ──────────────────────────────────────────────────────────────────────────────
# Timezone
# ──────────────────────────────────────────────────────────────────────────────
TIMEZONE=America/Sao_Paulo

# ──────────────────────────────────────────────────────────────────────────────
# VAD Settings
# ──────────────────────────────────────────────────────────────────────────────
VAD_SILERO_THRESHOLD=0.5
VAD_SILERO_MIN_SILENCE_MS=120

# ──────────────────────────────────────────────────────────────────────────────
# Recording Settings
# ──────────────────────────────────────────────────────────────────────────────
RECORDING_ENABLED=false
RECORDING_PATH=data/recordings
RECORDING_FORMAT=wav
RECORDING_SAMPLE_RATE=16000
RECORDING_INCLUDE_BOT_AUDIO=true

# ──────────────────────────────────────────────────────────────────────────────
# Turn Detection Settings
# ──────────────────────────────────────────────────────────────────────────────
USER_IDLE_TIMEOUT_SECONDS=15.0    # End call after this silence duration
USER_IDLE_WARNING_SECONDS=8.0     # Warn user after this silence duration
USER_IDLE_MAX_WARNINGS=2          # Max warnings before ending call
MUTE_DURING_FUNCTION_CALL=true    # Mute STT during tool execution
MUTE_FUNCTION_CALL_DURATION=3.0   # Seconds to mute after tool call starts
MUTE_UNTIL_FIRST_BOT_SPEECH=false # Wait for greeting before accepting input

# ──────────────────────────────────────────────────────────────────────────────
# Startup Optimization (Latency Reduction)
# ──────────────────────────────────────────────────────────────────────────────
EAGER_TOOL_LOADING=true           # Pre-load tools at startup
DIRECT_GREETING_INJECTION=true    # Send greeting directly via WebSocket
PARALLEL_CONTEXT_PREFETCH=true    # Fetch customer context in parallel

# ──────────────────────────────────────────────────────────────────────────────
# Post-Call Processing (Automatic Summary)
# ──────────────────────────────────────────────────────────────────────────────
AUTO_SAVE_CALL_SUMMARY=true       # Auto-save call summary after call ends
MIN_CALL_DURATION_TO_SAVE=5.0     # Min call duration (sec) to trigger save
USE_AI_SUMMARY_GENERATION=true    # Use AI to generate call summary

# ──────────────────────────────────────────────────────────────────────────────
# Twilio Credentials (for outbound calls)
# ──────────────────────────────────────────────────────────────────────────────
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_PHONE_NUMBER=+1234567890

# ──────────────────────────────────────────────────────────────────────────────
# Voicemail Detection (Twilio AMD)
# ──────────────────────────────────────────────────────────────────────────────
VOICEMAIL_DETECTION_ENABLED=false      # Enable Twilio AMD
VOICEMAIL_DETECTION_TIMEOUT=5          # Seconds to wait for AMD result
VOICEMAIL_SPEECH_THRESHOLD=2500        # ms of speech threshold
VOICEMAIL_MESSAGE_FILE=VOICEMAIL_PROMPT.md

# ──────────────────────────────────────────────────────────────────────────────
# WhatsApp Calling (Meta Business API - WebRTC)
# ──────────────────────────────────────────────────────────────────────────────
WHATSAPP_CALLING_ENABLED=false
WHATSAPP_PHONE_NUMBER_ID=your-whatsapp-phone-number-id
WHATSAPP_BUSINESS_ACCOUNT_ID=your-whatsapp-business-account-id
META_ACCESS_TOKEN=your-meta-access-token
META_APP_SECRET=your-meta-app-secret
WHATSAPP_CALLING_WEBHOOK_VERIFY_TOKEN=your-webhook-verify-token
WEBRTC_STUN_SERVER=stun:stun.l.google.com:19302
WEBRTC_AUDIO_CODEC=opus
